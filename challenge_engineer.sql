#CREACION DE LA BD
create database challenge_engineer;
USE challenge_engineer;

#CREACION DE TABLAS
CREATE TABLE AEROLINEAS (
ID_AEROLINEA INT,
NOMBRE_AEROLINEA VARCHAR (10),
primary key (ID_AEROLINEA)
);

CREATE TABLE AEROPUERTOS (
ID_AEROPUERTO INT,
NOMBRE_AEROPUERTO VARCHAR (30),
primary key (ID_AEROPUERTO)
);

CREATE TABLE MOVIMIENTOS (
ID_MOVIMIENTO INT,
DESCRIPCION VARCHAR(15),
primary key (ID_MOVIMIENTO)
);

CREATE TABLE VUELOS (
ID_AEROLINEA INT,
ID_AEROPUERTO INT,
ID_MOVIMIENTO INT,
DIA date,
foreign key (ID_AEROLINEA) REFERENCES AEROLINEAS (ID_AEROLINEA),
foreign key (ID_AEROPUERTO) REFERENCES AEROPUERTOS (ID_AEROPUERTO),
foreign key (ID_MOVIMIENTO) REFERENCES MOVIMIENTOS (ID_MOVIMIENTO)
);

#AGREGAR DATOS A TABLAS
INSERT INTO AEROLINEAS VALUES (1, "Volaris");
INSERT INTO AEROLINEAS VALUES (2, "Aeromar");
INSERT INTO AEROLINEAS VALUES (3, "Interjet");
INSERT INTO AEROLINEAS VALUES (4, "Aeromexico");


INSERT INTO AEROPUERTOS VALUES (1, "Benito Juarez");
INSERT INTO AEROPUERTOS VALUES (2, "Guanajuato");
INSERT INTO AEROPUERTOS VALUES (3, "La paz");
INSERT INTO AEROPUERTOS VALUES (4, "Oaxaca");


INSERT INTO MOVIMIENTOS VALUES (1, "Salida");
INSERT INTO MOVIMIENTOS VALUES (2, "Llegada");


INSERT INTO VUELOS VALUES (1, 1, 1, "2021-05-02");
INSERT INTO VUELOS VALUES (2, 1, 1, "2021-05-02");
INSERT INTO VUELOS VALUES (3, 2, 2, "2021-05-02");
INSERT INTO VUELOS VALUES (4, 3, 2, "2021-05-02");
INSERT INTO VUELOS VALUES (1, 3, 2, "2021-05-02");
INSERT INTO VUELOS VALUES (2, 1, 1, "2021-05-02");
INSERT INTO VUELOS VALUES (2, 3, 1, "2021-05-04");
INSERT INTO VUELOS VALUES (3, 4, 1, "2021-05-04");
INSERT INTO VUELOS VALUES (3, 4, 1, "2021-05-04");


#CONSULTAS
##1. ¿Cuál es el nombre aeropuerto que ha tenido mayor movimiento durante el año
SELECT ID_AEROPUERTO, COUNT(ID_AEROPUERTO) AS total_movimiento
FROM VUELOS
GROUP BY ID_AEROPUERTO
ORDER BY total_movimiento DESC;
select * FROM aeropuertos;
#BENITO JUAREZ Y LA PAZ SON LOS AEROPUERTOS CON MAS MOVIMIENTO DURANTE EL AÑO

##2. ¿Cuál es el nombre aerolínea que ha realizado mayor número de vuelos durante el año?
SELECT ID_AEROlINEA, count(ID_AEROLINEA) AS total_VUELOS_AÑO 
FROM VUELOS 
GROUP BY 1 
HAVING count(ID_AEROLINEA) > 1;
SELECT * FROM AEROLINEAS;
#AEROMAR E INTERJET SON LAS AEROLINEAS QUE CUENTAN CON MAS VUELOS DURANTE EL AÑO

##3. ¿En qué día se han tenido mayor número de vuelos?
SELECT DIA, COUNT(DIA) AS total_VUELOS_DIA
FROM VUELOS
GROUP BY DIA
ORDER BY total_VUELOS_DIA DESC;
#EL DIA QUE DE MAYOR NUMERO DE VUELOS ES EL 2021-05-02 CON UN TOTAL DE 6 VUELOS 

##4. ¿Cuáles son las aerolíneas que tienen mas de 2 vuelos por día##
SELECT ID_AEROLINEA, count(ID_AEROLINEA) AS VUELOS_MAYORES_A_DOS 
FROM VUELOS 
GROUP BY 1 
HAVING count(ID_AEROLINEA) > 2;
#AEROMAR E INTERJET SON LAS AEROLINEAS QUE CUENTAN CON MAS DE DOS VUELOS
SELECT * FROM AEROLINEAS;

